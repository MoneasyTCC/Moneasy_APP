{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail, signOut, onAuthStateChanged } from \"firebase/auth\";\nimport { app } from \"../shared/firebaseConfig\";\nimport { UsuariosDAL } from \"../Repo/RepositorioUsuario\";\nvar auth = getAuth(app);\nexport var createAccountWithEmail = function () {\n  var _ref = _asyncToGenerator(function* (email, password) {\n    try {\n      var userCredential = yield createUserWithEmailAndPassword(auth, email, password);\n      var firebaseUser = userCredential.user;\n      var userEmail = firebaseUser.email;\n      if (!userEmail) {\n        console.log(\"O email do usuário não está disponível.\");\n        throw new Error(\"O email do usuário não está disponível.\");\n      }\n      if (!firebaseUser) {\n        console.log;\n        throw new Error(\"Erro ao criar a conta do usuário.\");\n      }\n      var novoUsuario = {\n        usuarioId: firebaseUser.uid,\n        email: userEmail,\n        nome: \"\"\n      };\n      yield UsuariosDAL.adicionarUsuario(novoUsuario);\n      return firebaseUser;\n    } catch (error) {\n      console.log(\"deu erroo\");\n      throw error;\n    }\n  });\n  return function createAccountWithEmail(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\nexport var loginWithEmail = function () {\n  var _ref2 = _asyncToGenerator(function* (email, password) {\n    try {\n      var userCredential = yield signInWithEmailAndPassword(auth, email, password);\n      return userCredential.user;\n    } catch (error) {\n      throw error;\n    }\n  });\n  return function loginWithEmail(_x3, _x4) {\n    return _ref2.apply(this, arguments);\n  };\n}();\nexport var resetPasswordWithEmail = function () {\n  var _ref3 = _asyncToGenerator(function* (email) {\n    try {\n      yield sendPasswordResetEmail(auth, email);\n    } catch (error) {\n      throw error;\n    }\n  });\n  return function resetPasswordWithEmail(_x5) {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport var logout = function () {\n  var _ref4 = _asyncToGenerator(function* () {\n    try {\n      yield signOut(auth);\n    } catch (error) {\n      throw error;\n    }\n  });\n  return function logout() {\n    return _ref4.apply(this, arguments);\n  };\n}();\nexport var observeAuthState = function observeAuthState(onUserChanged) {\n  return onAuthStateChanged(auth, onUserChanged);\n};\nexport var getCurrentUserId = function () {\n  var _ref5 = _asyncToGenerator(function* () {\n    var auth = getAuth();\n    var user = auth.currentUser;\n    return user ? user.uid : null;\n  });\n  return function getCurrentUserId() {\n    return _ref5.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["getAuth","createUserWithEmailAndPassword","signInWithEmailAndPassword","sendPasswordResetEmail","signOut","onAuthStateChanged","app","UsuariosDAL","auth","createAccountWithEmail","_ref","_asyncToGenerator","email","password","userCredential","firebaseUser","user","userEmail","console","log","Error","novoUsuario","usuarioId","uid","nome","adicionarUsuario","error","_x","_x2","apply","arguments","loginWithEmail","_ref2","_x3","_x4","resetPasswordWithEmail","_ref3","_x5","logout","_ref4","observeAuthState","onUserChanged","getCurrentUserId","_ref5","currentUser"],"sources":["D:/APP_Financeiro/services/firebase-auth.ts"],"sourcesContent":["import { initializeApp } from 'firebase/app';\r\nimport { initializeAuth } from 'firebase/auth';\r\nimport ReactNativeAsyncStorage from '@react-native-async-storage/async-storage';\r\nimport {\r\n  getAuth,\r\n  createUserWithEmailAndPassword,\r\n  signInWithEmailAndPassword,\r\n  sendPasswordResetEmail,\r\n  signOut,\r\n  onAuthStateChanged,\r\n  User\r\n} from \"firebase/auth\";\r\nimport {app} from \"../shared/firebaseConfig\"\r\n\r\n\r\n\r\nimport {\r\n  Alert,\r\n} from \"react-native\";\r\nimport { Usuario } from \"../Model/Usuario\";\r\nimport { UsuariosDAL } from \"../Repo/RepositorioUsuario\";\r\n\r\n// Inicializa o Firebase\r\nconst auth = getAuth(app);\r\n\r\n// Função para registrar um novo usuário\r\nexport const createAccountWithEmail = async (email: string, password: string) => {\r\n  try {\r\n    const userCredential = await createUserWithEmailAndPassword(auth, email, password);\r\n    const firebaseUser = userCredential.user;\r\n    const userEmail = firebaseUser.email;\r\n\r\n    if (!userEmail) {\r\n         console.log(\"O email do usuário não está disponível.\");\r\n\r\n      throw new Error(\"O email do usuário não está disponível.\");\r\n    }\r\n    if (!firebaseUser) {\r\n      console.log\r\n      throw new Error(\"Erro ao criar a conta do usuário.\");\r\n    }\r\n\r\n    // Cria um novo objeto Usuario\r\n    const novoUsuario: Partial<Usuario> = {\r\n      usuarioId: firebaseUser.uid,\r\n      email: userEmail,\r\n      nome: \"\"\r\n    };\r\n    // Adiciona o usuário na coleção 'usuarios' do Firestore\r\n    await UsuariosDAL.adicionarUsuario(novoUsuario);\r\n\r\n    return firebaseUser;\r\n  } catch (error) {\r\n    console.log(\"deu erroo\")\r\n    throw error;\r\n  }\r\n};\r\n// Função para fazer login\r\nexport const loginWithEmail = async (email: string, password: string) => {\r\n  try {\r\n    const userCredential = await signInWithEmailAndPassword(auth, email, password);\r\n    return userCredential.user;\r\n  } catch (error) {\r\n    throw error;\r\n  }\r\n};\r\n\r\n  // Função para resetar a senha\r\nexport const resetPasswordWithEmail = async (email: string) => {\r\n  try {\r\n    await sendPasswordResetEmail(auth, email);\r\n  } catch (error) {\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Função para fazer logout\r\nexport const logout = async () => {\r\n  try {\r\n    await signOut(auth);\r\n  } catch (error) {\r\n    throw error;\r\n  }\r\n};\r\n\r\n// Função para acompanhar o estado de autenticação do usuário\r\nexport const observeAuthState = (onUserChanged: (user: User | null) => void) => {\r\n  return onAuthStateChanged(auth, onUserChanged);\r\n};\r\n\r\nexport const getCurrentUserId  = async () =>  {\r\n  const auth = getAuth(); \r\n  const user = auth.currentUser; \r\n  return user ? user.uid : null; \r\n};\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}