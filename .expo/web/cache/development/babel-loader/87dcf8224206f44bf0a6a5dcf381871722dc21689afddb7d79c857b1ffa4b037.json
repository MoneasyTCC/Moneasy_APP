{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nfunction ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }\nfunction _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }\nimport { getFirestore, collection, addDoc, query, where, getDocs, updateDoc, deleteDoc, doc } from \"firebase/firestore\";\nimport { getCurrentUserId } from \"../services/firebase-auth\";\nvar db = getFirestore();\nexport var TransacaoDAL = {\n  adicionarTransacao: function () {\n    var _adicionarTransacao = _asyncToGenerator(function* (novaTransacao) {\n      var usuarioId = yield getCurrentUserId();\n      if (!usuarioId) throw new Error(\"Usuário não autenticado.\");\n      try {\n        var docRef = yield addDoc(collection(db, 'transacoes'), _objectSpread(_objectSpread({}, novaTransacao), {}, {\n          usuarioId: usuarioId\n        }));\n        console.log(\"Transação adicionada com ID: \", docRef.id);\n        return docRef.id;\n      } catch (error) {\n        if (error instanceof Error) {\n          throw new Error(`Erro ao adicionar transação: ${error.message}`);\n        } else {\n          throw new Error('Ocorreu um erro desconhecido ao adicionar transação.');\n        }\n      }\n    });\n    function adicionarTransacao(_x) {\n      return _adicionarTransacao.apply(this, arguments);\n    }\n    return adicionarTransacao;\n  }(),\n  buscarTransacoes: function () {\n    var _buscarTransacoes = _asyncToGenerator(function* () {\n      var usuarioId = getCurrentUserId();\n      if (!usuarioId) throw new Error(\"Usuário não autenticado.\");\n      try {\n        var q = query(collection(db, 'transacoes'), where(\"usuarioId\", \"==\", usuarioId));\n        var querySnapshot = yield getDocs(q);\n        return querySnapshot.docs.map(function (doc) {\n          return _objectSpread({\n            id: doc.id\n          }, doc.data());\n        });\n      } catch (error) {\n        if (error instanceof Error) {\n          throw new Error(`Erro ao buscar transações: ${error.message}`);\n        } else {\n          throw new Error('Ocorreu um erro desconhecido ao buscar transações.');\n        }\n      }\n    });\n    function buscarTransacoes() {\n      return _buscarTransacoes.apply(this, arguments);\n    }\n    return buscarTransacoes;\n  }(),\n  deletarTransacao: function () {\n    var _deletarTransacao = _asyncToGenerator(function* (transacaoId) {\n      try {\n        yield deleteDoc(doc(db, 'transacoes', transacaoId));\n        console.log(\"Transação deletada com sucesso.\");\n      } catch (error) {\n        if (error instanceof Error) {\n          throw new Error(`Erro ao deletar transação: ${error.message}`);\n        } else {\n          throw new Error('Ocorreu um erro desconhecido ao deletar transação.');\n        }\n      }\n    });\n    function deletarTransacao(_x2) {\n      return _deletarTransacao.apply(this, arguments);\n    }\n    return deletarTransacao;\n  }(),\n  alterarTransacao: function () {\n    var _alterarTransacao = _asyncToGenerator(function* (transacaoId, novosDados) {\n      try {\n        var transacaoRef = doc(db, 'transacoes', transacaoId);\n        yield updateDoc(transacaoRef, novosDados);\n        console.log(\"Transação atualizada com sucesso.\");\n      } catch (error) {\n        if (error instanceof Error) {\n          throw new Error(`Erro ao atualizar transação: ${error.message}`);\n        } else {\n          throw new Error('Ocorreu um erro desconhecido ao atualizar transação.');\n        }\n      }\n    });\n    function alterarTransacao(_x3, _x4) {\n      return _alterarTransacao.apply(this, arguments);\n    }\n    return alterarTransacao;\n  }()\n};","map":{"version":3,"names":["getFirestore","collection","addDoc","query","where","getDocs","updateDoc","deleteDoc","doc","getCurrentUserId","db","TransacaoDAL","adicionarTransacao","_adicionarTransacao","_asyncToGenerator","novaTransacao","usuarioId","Error","docRef","_objectSpread","console","log","id","error","message","_x","apply","arguments","buscarTransacoes","_buscarTransacoes","q","querySnapshot","docs","map","data","deletarTransacao","_deletarTransacao","transacaoId","_x2","alterarTransacao","_alterarTransacao","novosDados","transacaoRef","_x3","_x4"],"sources":["D:/APP_Financeiro/Repo/Transacao.ts"],"sourcesContent":["import { \r\n    getFirestore, \r\n    collection, \r\n    addDoc, \r\n    query, \r\n    where, \r\n    getDocs, \r\n    updateDoc, \r\n    deleteDoc, \r\n    doc \r\n  } from \"firebase/firestore\";\r\n  \r\n  import { Transacao } from \"../shared/Model/Transacao\";\r\n  \r\n  import { getCurrentUserId } from \"../services/firebase-auth\";\r\n  \r\n  const db = getFirestore();\r\n  \r\n  export const TransacaoDAL = {\r\n    // Função para adicionar uma nova transação\r\n   adicionarTransacao: async (novaTransacao: Transacao) => {\r\n    const usuarioId = await getCurrentUserId();\r\n  if (!usuarioId) throw new Error(\"Usuário não autenticado.\");\r\n\r\n  try {\r\n    const docRef = await addDoc(collection(db, 'transacoes'), {\r\n      ...novaTransacao,\r\n      usuarioId: usuarioId // Garantindo que usuarioId é uma string, não uma Promise\r\n    });\r\n    console.log(\"Transação adicionada com ID: \", docRef.id);\r\n    return docRef.id;\r\n      } catch (error: unknown) {\r\n        if (error instanceof Error) {\r\n          throw new Error(`Erro ao adicionar transação: ${error.message}`);\r\n        } else {\r\n          throw new Error('Ocorreu um erro desconhecido ao adicionar transação.');\r\n        }\r\n      }\r\n    },\r\n  \r\n    // Função para recuperar todas as transações de um usuário\r\n    buscarTransacoes: async () => {\r\n      const usuarioId = getCurrentUserId();\r\n      if (!usuarioId) throw new Error(\"Usuário não autenticado.\");\r\n  \r\n      try {\r\n        const q = query(collection(db, 'transacoes'), where(\"usuarioId\", \"==\", usuarioId));\r\n        const querySnapshot = await getDocs(q);\r\n        return querySnapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));\r\n      } catch (error: unknown) {\r\n        if (error instanceof Error) {\r\n          throw new Error(`Erro ao buscar transações: ${error.message}`);\r\n        } else {\r\n          throw new Error('Ocorreu um erro desconhecido ao buscar transações.');\r\n        }\r\n      }\r\n    },\r\n  \r\n    // Função para deletar uma transação\r\n    deletarTransacao: async (transacaoId: string) => {\r\n      try {\r\n        await deleteDoc(doc(db, 'transacoes', transacaoId));\r\n        console.log(\"Transação deletada com sucesso.\");\r\n      } catch (error: unknown) {\r\n        if (error instanceof Error) {\r\n          throw new Error(`Erro ao deletar transação: ${error.message}`);\r\n        } else {\r\n          throw new Error('Ocorreu um erro desconhecido ao deletar transação.');\r\n        }\r\n      }\r\n    },\r\n  \r\n    // Método para alterar uma transação\r\n    alterarTransacao: async (transacaoId: string, novosDados: Partial<Transacao>) => {\r\n      try {\r\n        const transacaoRef = doc(db, 'transacoes', transacaoId);\r\n        await updateDoc(transacaoRef, novosDados);\r\n        console.log(\"Transação atualizada com sucesso.\");\r\n      } catch (error: unknown) {\r\n        if (error instanceof Error) {\r\n          throw new Error(`Erro ao atualizar transação: ${error.message}`);\r\n        } else {\r\n          throw new Error('Ocorreu um erro desconhecido ao atualizar transação.');\r\n        }\r\n      }\r\n    }\r\n  };\r\n  "],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}